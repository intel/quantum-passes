// NOTE: Assertions have been autogenerated by utils/update_cc_test_checks.py UTC_ARGS: --version 3
// RUN: %clang -S -emit-llvm %include_dirs %loadintelclangextensions  %s -o - | FileCheck %s --dump-input fail


#include "clang/Quantum/quintrinsics.h"

const unsigned N = 10;
qbit q[N];

// CHECK-LABEL: define dso_local void @_Z10simpleLoopv(
// CHECK-SAME: ) #[[ATTR0:[0-9]+]] section ".qbbs_text" {
// CHECK:    [[I:%.*]] = alloca i32, align 4
// CHECK-NEXT:    store i32 0, ptr [[I]], align 4
// CHECK-NEXT:    br label %[[FOR_COND:.*]]
// CHECK:       [[FOR_COND]]:
// CHECK-NEXT:    [[TMP0:%.*]] = load i32, ptr [[I]], align 4
// CHECK-NEXT:    [[CMP:%.*]] = icmp ult i32 [[TMP0]], 10
// CHECK-NEXT:    br i1 [[CMP]], label %[[FOR_BODY:.*]], label %[[FOR_END:.*]]
// CHECK:       [[FOR_BODY]]:
// CHECK-NEXT:    [[TMP1:%.*]] = load i32, ptr [[I]], align 4
// CHECK-NEXT:    [[IDXPROM:%.*]] = sext i32 [[TMP1]] to i64
// CHECK-NEXT:    [[ARRAYIDX:%.*]] = getelementptr inbounds [10 x i16], ptr @q, i64 0, i64 [[IDXPROM]]
// CHECK-NEXT:    call void @_Z5PrepXRt(ptr noundef nonnull align 2 dereferenceable(2) [[ARRAYIDX]])
// CHECK-NEXT:    br label %[[FOR_INC:.*]]
// CHECK:       [[FOR_INC]]:
// CHECK-NEXT:    [[TMP2:%.*]] = load i32, ptr [[I]], align 4
// CHECK-NEXT:    [[INC:%.*]] = add nsw i32 [[TMP2]], 1
// CHECK-NEXT:    store i32 [[INC]], ptr [[I]], align 4
// CHECK-NEXT:    br label %[[FOR_COND]], !llvm.loop [[LOOP6:![0-9]+]]
// CHECK:       [[FOR_END]]:
// CHECK-NEXT:    call void @_Z4CNOTRtS_(ptr noundef nonnull align 2 dereferenceable(2) @q, ptr noundef nonnull align 2 dereferenceable(2) getelementptr inbounds ([10 x i16], ptr @q, i64 0, i64 1))
// CHECK-NEXT:    call void @_Z4CNOTRtS_(ptr noundef nonnull align 2 dereferenceable(2) getelementptr inbounds ([10 x i16], ptr @q, i64 0, i64 2), ptr noundef nonnull align 2 dereferenceable(2) getelementptr inbounds ([10 x i16], ptr @q, i64 0, i64 3))
// CHECK-NEXT:    call void @_Z2RXRtd(ptr noundef nonnull align 2 dereferenceable(2) getelementptr inbounds ([10 x i16], ptr @q, i64 0, i64 4), double noundef 1.000000e-01)
// CHECK-NEXT:    ret void
//
quantum_kernel void simpleLoop() {
    for (int i = 0; i < N; i++) {
        PrepX(q[i]);
    }
    CNOT(q[0], q[1]);
    CNOT(q[2], q[3]);
    RX(q[4], 0.1);
}


















